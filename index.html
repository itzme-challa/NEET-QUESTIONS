<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NEET Quiz Explorer</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #e0e7ff, #e6e6e6);
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      max-width: 800px;
      width: 100%;
      background: white;
      border-radius: 15px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
      padding: 30px;
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    h2 {
      text-align: center;
      color: #1a3c7a;
      font-size: 2em;
      margin-bottom: 20px;
      font-weight: 600;
    }
    select, button {
      padding: 12px;
      margin: 10px 0;
      width: 100%;
      max-width: 400px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 1em;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }
    select {
      background: #f9fafb;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23666666'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1em;
    }
    select:focus, button:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    button {
      background: #3b82f6;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 500;
    }
    button:hover {
      background: #2563eb;
    }
    button:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    .quiz-box {
      background: #f9fafb;
      padding: 20px;
      margin-top: 20px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      transition: all 0.3s ease;
    }
    .question {
      font-size: 1.3em;
      margin-bottom: 15px;
      color: #1f2937;
      font-weight: 500;
    }
    .options button {
      display: block;
      margin: 8px 0;
      padding: 12px;
      width: 100%;
      background: #ffffff;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      cursor: pointer;
      text-align: left;
      transition: all 0.3s ease;
    }
    .options button:hover {
      background: #f3f4f6;
    }
    .hidden {
      display: none;
    }
    .correct {
      background: #d1fae5;
      border-color: #10b981;
      color: #065f46;
    }
    .wrong {
      background: #fee2e2;
      border-color: #ef4444;
      color: #991b1b;
    }
    .explanation {
      margin-top: 15px;
      padding: 15px;
      background: #f1f5f9;
      border-radius: 8px;
      color: #4b5563;
      font-size: 0.95em;
      line-height: 1.5;
    }
    iframe {
      border: none;
      border-radius: 8px;
      width: 100%;
      height: 300px;
    }
    .error {
      color: #dc2626;
      text-align: center;
      margin-top: 10px;
    }
    .dropdown-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    @media (max-width: 600px) {
      .container {
        padding: 20px;
      }
      h2 {
        font-size: 1.5em;
      }
      select, button {
        max-width: 100%;
      }
      .quiz-box {
        padding: 15px;
      }
      iframe {
        height: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>NEET Topic-Wise Quiz Explorer</h2>
    <div class="dropdown-container">
      <select id="subjectSelect">
        <option value="">Select Subject</option>
        <option value="biology">Biology</option>
        <option value="chemistry">Chemistry</option>
        <option value="physics">Physics</option>
      </select>

      <select id="chapterSelect" class="hidden"></select>
      <select id="unitSelect" class="hidden"></select>
      <select id="topicSelect" class="hidden"></select>
      <select id="quizTypeSelect" class="hidden"></select>
    </div>
    <button id="startQuizBtn" class="hidden">Start Quiz</button>

    <div class="quiz-box hidden" id="quizBox">
      <div id="quizContent"></div>
      <button id="nextBtn">Next</button>
    </div>
  </div>

  <script>
    const subjectUrls = {
      biology: 'https://itzfew.github.io/NEET-Questions/data/biology.json',
      chemistry: 'https://itzfew.github.io/NEET-Questions/data/chemistry.json',
      physics: 'https://itzfew.github.io/NEET-Questions/data/physics.json',
    };

    let fullData = [];
    let currentQuestions = [];
    let currentIndex = 0;

    const subjectSelect = document.getElementById('subjectSelect');
    const chapterSelect = document.getElementById('chapterSelect');
    const unitSelect = document.getElementById('unitSelect');
    const topicSelect = document.getElementById('topicSelect');
    const quizTypeSelect = document.getElementById('quizTypeSelect');
    const startQuizBtn = document.getElementById('startQuizBtn');
    const quizBox = document.getElementById('quizBox');
    const quizContent = document.getElementById('quizContent');
    const nextBtn = document.getElementById('nextBtn');

    subjectSelect.addEventListener('change', async () => {
      resetAll();
      const subject = subjectSelect.value;
      if (!subject) return;
      try {
        const url = subjectUrls[subject];
        const res = await fetch(url);
        if (!res.ok) throw new Error('Failed to fetch data');
        fullData = await res.json();
        const chapters = [...new Set(fullData.map(q => getChapterName(q)))].filter(Boolean).sort();
        populateDropdown(chapterSelect, chapters, 'Select Chapter');
        chapterSelect.classList.remove('hidden');
      } catch (error) {
        quizContent.innerHTML = '<p class="error">Error loading data. Please try again.</p>';
        quizBox.classList.remove('hidden');
        nextBtn.classList.add('hidden');
      }
    });

    chapterSelect.addEventListener('change', () => {
      unitSelect.innerHTML = '';
      topicSelect.innerHTML = '';
      quizTypeSelect.innerHTML = '';
      quizTypeSelect.classList.add('hidden');
      startQuizBtn.classList.add('hidden');
      const chapter = chapterSelect.value;
      if (!chapter) return;
      const units = [...new Set(fullData
        .filter(q => getChapterName(q) === chapter)
        .map(q => getUnitName(q)))].filter(Boolean).sort();
      populateDropdown(unitSelect, units, 'Select Unit');
      unitSelect.classList.remove('hidden');
    });

    unitSelect.addEventListener('change', () => {
      topicSelect.innerHTML = '';
      quizTypeSelect.innerHTML = '';
      quizTypeSelect.classList.add('hidden');
      startQuizBtn.classList.add('hidden');
      const chapter = chapterSelect.value;
      const unit = unitSelect.value;
      if (!unit) return;
      const topics = [...new Set(fullData
        .filter(q => getChapterName(q) === chapter && getUnitName(q) === unit)
        .map(q => getTopicName(q)))].filter(Boolean).sort();
      populateDropdown(topicSelect, topics, 'Select Topic');
      topicSelect.classList.remove('hidden');
    });

    topicSelect.addEventListener('change', () => {
      quizTypeSelect.innerHTML = '';
      startQuizBtn.classList.add('hidden');
      const chapter = chapterSelect.value;
      const unit = unitSelect.value;
      const topic = topicSelect.value;
      if (!topic) return;
      const quizTypes = [...new Set(fullData
        .filter(q => getChapterName(q) === chapter && getUnitName(q) === unit && getTopicName(q) === topic)
        .map(q => q.quiz_type))].filter(Boolean).sort();
      populateDropdown(quizTypeSelect, quizTypes, 'Select Quiz Type');
      quizTypeSelect.classList.remove('hidden');
      startQuizBtn.classList.remove('hidden');
    });

    startQuizBtn.addEventListener('click', () => {
      const chapter = chapterSelect.value;
      const unit = unitSelect.value;
      const topic = topicSelect.value;
      const quizType = quizTypeSelect.value;
      currentQuestions = fullData.filter(q => {
        return getChapterName(q) === chapter &&
               getUnitName(q) === unit &&
               getTopicName(q) === topic &&
               (!quizType || q.quiz_type === quizType);
      });
      currentIndex = 0;
      if (currentQuestions.length > 0) {
        quizBox.classList.remove('hidden');
        showQuestion(currentQuestions[currentIndex]);
      } else {
        quizContent.innerHTML = '<p class="error">No questions found for selected filters.</p>';
        quizBox.classList.remove('hidden');
        nextBtn.classList.add('hidden');
      }
    });

    nextBtn.addEventListener('click', () => {
      currentIndex++;
      if (currentIndex < currentQuestions.length) {
        showQuestion(currentQuestions[currentIndex]);
      } else {
        quizContent.innerHTML = `<h3 class="question">Quiz Finished!</h3>`;
        nextBtn.classList.add('hidden');
      }
    });

    function showQuestion(q) {
      let html = `<div class="question">${q.question}</div>`;
      if (q.quiz_type === 'mcq') {
        html += `<div class="options">
          ${q.option_a ? `<button onclick="checkAnswer(this, '${q.answer.replace(/'/g, "\\'")}')">${q.option_a}</button>` : ''}
          ${q.option_b ? `<button onclick="checkAnswer(this, '${q.answer.replace(/'/g, "\\'")}')">${q.option_b}</button>` : ''}
          ${q.option_c ? `<button onclick="checkAnswer(this, '${q.answer.replace(/'/g, "\\'")}')">${q.option_c}</button>` : ''}
          ${q.option_d ? `<button onclick="checkAnswer(this, '${q.answer.replace(/'/g, "\\'")}')">${q.option_d}</button>` : ''}
        </div>`;
        if (q.explanation) {
          html += `<div class="explanation hidden">${q.explanation}</div>`;
        }
      } else if (q.quiz_type === 'flashcard') {
        html += `<p><strong>Answer:</strong> ${q.answer}</p>`;
        if (q.explanation) {
          html += `<div class="explanation">${q.explanation}</div>`;
        }
      } else if (q.quiz_type === 'fillup') {
        html += `<p><strong>Answer:</strong> ${q.answer}</p>`;
        if (q.explanation) {
          html += `<div class="explanation">${q.explanation}</div>`;
        }
      } else if (q.quiz_type === 'video') {
        html += `<iframe width="100%" height="300" src="https://www.youtube.com/embed/${q.question}" allowfullscreen></iframe>`;
        if (q.explanation) {
          html += `<div class="explanation">${q.explanation}</div>`;
        }
      } else if (q.quiz_type === 'match') {
        html += `<p><strong>Answer:</strong> ${q.answer}</p>`;
        if (q.option_a) html += `<p>Option A: ${q.option_a}</p>`;
        if (q.option_b) html += `<p>Option B: ${q.option_b}</p>`;
        if (q.explanation) {
          html += `<div class="explanation">${q.explanation}</div>`;
        }
      }
      quizContent.innerHTML = html;
      nextBtn.classList.remove('hidden');
    }

    function checkAnswer(button, correctAnswer) {
      const allButtons = button.parentElement.querySelectorAll('button');
      const explanation = button.parentElement.parentElement.querySelector('.explanation');
      allButtons.forEach(btn => {
        if (btn.textContent === correctAnswer) {
          btn.classList.add('correct');
        } else {
          btn.classList.add('wrong');
        }
        btn.disabled = true;
      });
      if (explanation) {
        explanation.classList.remove('hidden');
      }
    }

    function getChapterName(q) {
      return q['Chapter Name'] || q['chapter name'] || q['Unique Chapter Name'] || q.topic_name.split('>>')[0]?.trim() || '';
    }

    function getUnitName(q) {
      const parts = q.topic_name.split('>>');
      return parts[1]?.trim() || '';
    }

    function getTopicName(q) {
      const parts = q.topic_name.split('>>');
      return parts[2]?.trim() || '';
    }

    function populateDropdown(dropdown, items, defaultText) {
      dropdown.innerHTML = `<option value="">${defaultText}</option>`;
      items.forEach(item => {
        dropdown.innerHTML += `<option value="${item}">${item}</option>`;
      });
    }

    function resetAll() {
      chapterSelect.classList.add('hidden');
      unitSelect.classList.add('hidden');
      topicSelect.classList.add('hidden');
      quizTypeSelect.classList.add('hidden');
      startQuizBtn.classList.add('hidden');
      quizBox.classList.add('hidden');
      chapterSelect.innerHTML = '';
      unitSelect.innerHTML = '';
      topicSelect.innerHTML = '';
      quizTypeSelect.innerHTML = '';
      quizContent.innerHTML = '';
      nextBtn.classList.add('hidden');
    }
  </script>
</body>
</html>
